(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[531],{34687:function(I){I.exports={container:"container___1sYa-",lang:"lang___l6cji",content:"content___2zk1-",icon:"icon___rzGKO"}},80979:function(I,N,a){"use strict";a.r(N),a.d(N,{default:function(){return se}});var ue=a(18106),F=a(7027),oe=a(34792),y=a(48086),g=a(39428),M=a(11849),x=a(3182),P=a(2824),ge=a(17462),W=a(76772),G=a(71390),V=a(85300),r=a(25377);function Y(Z,m){return C.apply(this,arguments)}function C(){return C=(0,x.Z)((0,g.Z)().mark(function Z(m,h){return(0,g.Z)().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",(0,r.WY)("/api/login/captcha",(0,M.Z)({method:"GET",params:(0,M.Z)({},m)},h||{})));case 1:case"end":return v.stop()}},Z)})),C.apply(this,arguments)}var K=a(36108),J=a(48107),Q=a(39464),X=a(89366),O=a(2603),w=a(80521),k=a(70469),S=a(5966),q=a(16434),_=a(63434),A=a(67294),U=a(24480),ee=a(34687),d=a.n(ee),e=a(85893),H=function(m){var h=m.content;return(0,e.jsx)(W.Z,{style:{marginBottom:24},message:h,type:"error",showIcon:!0})},ae=function(){var m=(0,A.useState)({}),h=(0,P.Z)(m,2),B=h[0],v=h[1],re=(0,A.useState)("account"),b=(0,P.Z)(re,2),L=b[0],ne=b[1],$=(0,r.tT)("@@initialState"),f=$.initialState,te=$.setInitialState,u=(0,r.YB)(),ie=function(){var p=(0,x.Z)((0,g.Z)().mark(function i(){var l,c,t,s;return(0,g.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,f==null||(l=f.fetchUserInfo)===null||l===void 0?void 0:l.call(f);case 2:return t=o.sent,o.next=5,f==null||(c=f.fetchRoleMenuInfo)===null||c===void 0?void 0:c.call(f,{roleType:t==null?void 0:t.roleType,category:1});case 5:return s=o.sent,console.log(s,"login"),o.next=9,te(function(j){return(0,M.Z)((0,M.Z)({},j),{},{currentUser:t,currentMenu:s})});case 9:case"end":return o.stop()}},i)}));return function(){return p.apply(this,arguments)}}(),le=function(){var p=(0,x.Z)((0,g.Z)().mark(function i(l){var c,t,s,T,o,j,E,R;return(0,g.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return c={clientstr:(0,U.HI)({loginNo:l.username,password:btoa(encodeURI(l.password)),osVersion:"pc",clientType:2,loginType:1}),oldUrlFix:"",enabled:1},n.prev=1,n.next=4,(0,V.x4)(c);case 4:if(t=n.sent,s=JSON.parse((0,U.pe)(t)),console.log("\u767B\u5F55\u8FD4\u56DE",s),!(s.messageCode===1011||s.messageCode===1043)){n.next=18;break}return T=u.formatMessage({id:"pages.login.success",defaultMessage:"\u767B\u5F55\u6210\u529F\uFF01"}),y.ZP.success(T),n.next=12,ie();case 12:if(r.m8){n.next=14;break}return n.abrupt("return");case 14:return o=r.m8.location.query,j=o,E=j.redirect,r.m8.push(E||"/"),n.abrupt("return");case 18:v(s),n.next=25;break;case 21:n.prev=21,n.t0=n.catch(1),R=u.formatMessage({id:"pages.login.failure",defaultMessage:"\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\uFF01"}),y.ZP.error(R);case 25:case"end":return n.stop()}},i,null,[[1,21]])}));return function(l){return p.apply(this,arguments)}}(),z=B.status,D=B.type;return(0,e.jsxs)("div",{className:d().container,children:[(0,e.jsx)("div",{className:d().lang,"data-lang":!0,children:r.pD&&(0,e.jsx)(r.pD,{})}),(0,e.jsx)("div",{className:d().content,children:(0,e.jsxs)(k.U,{logo:(0,e.jsx)("img",{alt:"logo",src:"/logo.svg"}),title:"Ant Design",subTitle:u.formatMessage({id:"pages.layouts.userLayout.title"}),initialValues:{autoLogin:!0},actions:[(0,e.jsx)(r._H,{id:"pages.login.loginWith",defaultMessage:"\u5176\u4ED6\u767B\u5F55\u65B9\u5F0F"},"loginWith"),(0,e.jsx)(K.Z,{className:d().icon},"AlipayCircleOutlined"),(0,e.jsx)(J.Z,{className:d().icon},"TaobaoCircleOutlined"),(0,e.jsx)(Q.Z,{className:d().icon},"WeiboCircleOutlined")],onFinish:function(){var p=(0,x.Z)((0,g.Z)().mark(function i(l){return(0,g.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,le(l);case 2:case"end":return t.stop()}},i)}));return function(i){return p.apply(this,arguments)}}(),children:[(0,e.jsxs)(F.Z,{activeKey:L,onChange:ne,children:[(0,e.jsx)(F.Z.TabPane,{tab:u.formatMessage({id:"pages.login.accountLogin.tab",defaultMessage:"\u8D26\u6237\u5BC6\u7801\u767B\u5F55"})},"account"),(0,e.jsx)(F.Z.TabPane,{tab:u.formatMessage({id:"pages.login.phoneLogin.tab",defaultMessage:"\u624B\u673A\u53F7\u767B\u5F55"})},"mobile")]}),z==="error"&&D==="account"&&(0,e.jsx)(H,{content:u.formatMessage({id:"pages.login.accountLogin.errorMessage",defaultMessage:"\u8D26\u6237\u6216\u5BC6\u7801\u9519\u8BEF(admin/ant.design)"})}),L==="account"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(S.Z,{name:"username",fieldProps:{size:"large",prefix:(0,e.jsx)(X.Z,{className:d().prefixIcon})},placeholder:u.formatMessage({id:"pages.login.username.placeholder",defaultMessage:"\u7528\u6237\u540D: admin or user"}),rules:[{required:!0,message:(0,e.jsx)(r._H,{id:"pages.login.username.required",defaultMessage:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"})}]}),(0,e.jsx)(S.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,e.jsx)(O.Z,{className:d().prefixIcon})},placeholder:u.formatMessage({id:"pages.login.password.placeholder",defaultMessage:"\u5BC6\u7801: ant.design"}),rules:[{required:!0,message:(0,e.jsx)(r._H,{id:"pages.login.password.required",defaultMessage:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"})}]})]}),z==="error"&&D==="mobile"&&(0,e.jsx)(H,{content:"\u9A8C\u8BC1\u7801\u9519\u8BEF"}),L==="mobile"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(S.Z,{fieldProps:{size:"large",prefix:(0,e.jsx)(w.Z,{className:d().prefixIcon})},name:"mobile",placeholder:u.formatMessage({id:"pages.login.phoneNumber.placeholder",defaultMessage:"\u624B\u673A\u53F7"}),rules:[{required:!0,message:(0,e.jsx)(r._H,{id:"pages.login.phoneNumber.required",defaultMessage:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\uFF01"})},{pattern:/^1\d{10}$/,message:(0,e.jsx)(r._H,{id:"pages.login.phoneNumber.invalid",defaultMessage:"\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF\uFF01"})}]}),(0,e.jsx)(q.Z,{fieldProps:{size:"large",prefix:(0,e.jsx)(O.Z,{className:d().prefixIcon})},captchaProps:{size:"large"},placeholder:u.formatMessage({id:"pages.login.captcha.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}),captchaTextRender:function(i,l){return i?"".concat(l," ").concat(u.formatMessage({id:"pages.getCaptchaSecondText",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})):u.formatMessage({id:"pages.login.phoneLogin.getVerificationCode",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})},name:"captcha",rules:[{required:!0,message:(0,e.jsx)(r._H,{id:"pages.login.captcha.required",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801\uFF01"})}],onGetCaptcha:function(){var p=(0,x.Z)((0,g.Z)().mark(function i(l){var c;return(0,g.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Y({phone:l});case 2:if(c=s.sent,c!==!1){s.next=5;break}return s.abrupt("return");case 5:y.ZP.success("\u83B7\u53D6\u9A8C\u8BC1\u7801\u6210\u529F\uFF01\u9A8C\u8BC1\u7801\u4E3A\uFF1A1234");case 6:case"end":return s.stop()}},i)}));return function(i){return p.apply(this,arguments)}}()})]}),(0,e.jsxs)("div",{style:{marginBottom:24},children:[(0,e.jsx)(_.Z,{noStyle:!0,name:"autoLogin",children:(0,e.jsx)(r._H,{id:"pages.login.rememberMe",defaultMessage:"\u81EA\u52A8\u767B\u5F55"})}),(0,e.jsx)("a",{style:{float:"right"},children:(0,e.jsx)(r._H,{id:"pages.login.forgotPassword",defaultMessage:"\u5FD8\u8BB0\u5BC6\u7801"})})]})]})}),(0,e.jsx)(G.Z,{})]})},se=ae}}]);
